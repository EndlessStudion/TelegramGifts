<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram Star Clicker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
            font-family: 'Segoe UI', system-ui, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background: linear-gradient(135deg, #0a1a2a 0%, #152238 100%);
            color: #F5F9FF;
            min-height: 100vh;
            overflow-x: hidden;
            cursor: default;
            touch-action: pan-y;
        }

        .top-bar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(20, 30, 48, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 8px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            height: 60px;
        }

        .counters-container {
            display: flex;
            align-items: center;
            gap: 20px;
            min-width: 250px;
        }

        .counter-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            background: rgba(255, 255, 255, 0.07);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            min-width: 120px;
        }

        .counter-icon {
            width: 22px;
            height: 22px;
            object-fit: contain;
            -webkit-user-drag: none;
        }

        .star-icon {
            animation: starPulse 2s ease-in-out infinite;
            filter: drop-shadow(0 0 6px #FFD700);
        }

        .ton-icon {
            animation: tonPulse 2s ease-in-out infinite 0.3s;
        }

        @keyframes starPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes tonPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .counter-info {
            display: flex;
            flex-direction: column;
        }

        .counter-label {
            font-size: 0.7rem;
            color: #a0b1c8;
            font-weight: 500;
        }

        .counter-value {
            font-size: 1.2rem;
            font-weight: 800;
            line-height: 1;
        }

        .stars-counter .counter-value {
            color: #FFD700;
            text-shadow: 0 0 8px rgba(255, 215, 0, 0.3);
        }

        .ton-counter .counter-value {
            color: #0088CC;
            text-shadow: 0 0 8px rgba(0, 136, 204, 0.3);
        }

        .top-controls {
            display: flex;
            align-items: center;
            gap: 15px;
            overflow-x: auto;
            overflow-y: hidden;
            padding: 5px 0;
            max-width: 500px;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .top-controls::-webkit-scrollbar {
            display: none;
            height: 0;
        }

        .exchange-btn-top, .promo-btn-top, .shop-btn-top, .inventory-btn-top {
            background: linear-gradient(135deg, #0088CC, #006699);
            color: white;
            border: none;
            border-radius: 10px;
            padding: 8px 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.85rem;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .promo-btn-top {
            background: linear-gradient(135deg, #FF4081, #D81B60);
        }

        .shop-btn-top {
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
        }

        .inventory-btn-top {
            background: linear-gradient(135deg, #FF9800, #EF6C00);
        }

        .exchange-btn-top:hover {
            transform: translateY(-1px);
            background: linear-gradient(135deg, #0099EE, #0077AA);
            box-shadow: 0 4px 12px rgba(0, 136, 204, 0.3);
        }

        .promo-btn-top:hover {
            transform: translateY(-1px);
            background: linear-gradient(135deg, #FF5C8D, #E91E63);
            box-shadow: 0 4px 12px rgba(255, 64, 129, 0.3);
        }

        .shop-btn-top:hover {
            transform: translateY(-1px);
            background: linear-gradient(135deg, #66BB6A, #388E3C);
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
        }

        .inventory-btn-top:hover {
            transform: translateY(-1px);
            background: linear-gradient(135deg, #FFB74D, #F57C00);
            box-shadow: 0 4px 12px rgba(255, 152, 0, 0.3);
        }

        .exchange-btn-top:active, .promo-btn-top:active, .shop-btn-top:active, .inventory-btn-top:active {
            transform: translateY(0);
        }

        .content {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 80px 20px 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 25px;
            margin-top: 10px;
        }

        .title {
            font-size: 2.5rem;
            background: linear-gradient(90deg, #2AABEE, #FFD700);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            font-weight: 800;
            margin-bottom: 5px;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .subtitle {
            color: #8E9BAE;
            font-size: 0.9rem;
            font-weight: 300;
        }

        .click-area {
            width: 260px;
            height: 260px;
            cursor: pointer;
            margin: 30px 0;
            position: relative;
            transition: transform 0.15s ease;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255,215,0,0.1) 0%, transparent 70%);
            touch-action: manipulation;
        }

        .click-area:hover {
            transform: scale(1.02);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.4);
        }

        .click-area:active {
            transform: scale(0.95);
        }

        .main-star {
            width: 100%;
            height: 100%;
            object-fit: contain;
            filter: drop-shadow(0 0 25px rgba(255, 215, 0, 0.7));
            animation: starFloat 4s ease-in-out infinite;
            -webkit-user-drag: none;
        }

        @keyframes starFloat {
            0%, 100% { 
                transform: translateY(0) rotate(0deg);
            }
            50% { 
                transform: translateY(-10px) rotate(5deg);
            }
        }

        /* –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –∏–∫–æ–Ω–∫–∞ TON (–±–µ–∑ –±–µ–ª–æ–≥–æ —Ñ–æ–Ω–∞) */
        .ton-icon-fixed {
            filter: invert(27%) sepia(98%) saturate(2000%) hue-rotate(180deg) brightness(90%) contrast(90%) drop-shadow(0 0 6px rgba(0, 136, 204, 0.7));
        }

        .ton-result-icon {
            filter: invert(27%) sepia(98%) saturate(2000%) hue-rotate(180deg) brightness(90%) contrast(90%) drop-shadow(0 0 5px rgba(0, 136, 204, 0.5));
        }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ —Å —É–ª—É—á—à–µ–Ω–Ω—ã–º–∏ –∞–Ω–∏–º–∞—Ü–∏—è–º–∏ */
        .exchange-modal, .promo-modal, .shop-modal, .inventory-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0);
            backdrop-filter: blur(0px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            pointer-events: none;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .exchange-modal.active, .promo-modal.active, .shop-modal.active, .inventory-modal.active {
            display: flex;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
            pointer-events: auto;
            animation: modalFadeIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .exchange-modal.closing, .promo-modal.closing, .shop-modal.closing, .inventory-modal.closing {
            animation: modalFadeOut 0.3s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }

        @keyframes modalFadeIn {
            from {
                opacity: 0;
                background: rgba(0, 0, 0, 0);
                backdrop-filter: blur(0px);
            }
            to {
                opacity: 1;
                background: rgba(0, 0, 0, 0.7);
                backdrop-filter: blur(10px);
            }
        }

        @keyframes modalFadeOut {
            from {
                opacity: 1;
                background: rgba(0, 0, 0, 0.7);
                backdrop-filter: blur(10px);
            }
            to {
                opacity: 0;
                background: rgba(0, 0, 0, 0);
                backdrop-filter: blur(0px);
            }
        }

        .exchange-panel, .promo-panel, .shop-panel, .inventory-panel {
            background: linear-gradient(135deg, rgba(15, 25, 40, 0.95), rgba(10, 20, 35, 0.95));
            border-radius: 20px;
            padding: 25px;
            width: 420px;
            max-width: 95%;
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
            transform: translateY(30px) scale(0.95);
            opacity: 0;
            transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .exchange-modal.active .exchange-panel,
        .promo-modal.active .promo-panel,
        .shop-modal.active .shop-panel,
        .inventory-modal.active .inventory-panel {
            transform: translateY(0) scale(1);
            opacity: 1;
            animation: panelSlideIn 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .exchange-modal.closing .exchange-panel,
        .promo-modal.closing .promo-panel,
        .shop-modal.closing .shop-panel,
        .inventory-modal.closing .inventory-panel {
            transform: translateY(20px) scale(0.95);
            opacity: 0;
            animation: panelSlideOut 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes panelSlideIn {
            0% {
                transform: translateY(30px) scale(0.95);
                opacity: 0;
            }
            70% {
                transform: translateY(-5px) scale(1.02);
                opacity: 1;
            }
            100% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
        }

        @keyframes panelSlideOut {
            0% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
            100% {
                transform: translateY(20px) scale(0.95);
                opacity: 0;
            }
        }

        .exchange-header, .promo-header, .shop-header, .inventory-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .exchange-title, .promo-title, .shop-title, .inventory-title {
            font-size: 1.3rem;
            color: #FFD700;
            font-weight: 600;
        }

        .promo-title {
            color: #FF4081;
        }

        .shop-title {
            color: #4CAF50;
        }

        .inventory-title {
            color: #FF9800;
        }

        .close-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: #a0b1c8;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            color: white;
            transform: rotate(90deg);
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –º–∞–≥–∞–∑–∏–Ω–∞ (—É–ø—Ä–æ—â—ë–Ω–Ω—ã–µ) */
        .shop-items-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin-bottom: 20px;
            max-height: 500px;
            overflow-y: auto;
            padding-right: 10px;
        }

        .shop-items-container::-webkit-scrollbar {
            width: 6px;
        }

        .shop-items-container::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
        }

        .shop-items-container::-webkit-scrollbar-thumb {
            background: rgba(76, 175, 80, 0.5);
            border-radius: 3px;
        }

        .shop-items-container::-webkit-scrollbar-thumb:hover {
            background: rgba(76, 175, 80, 0.7);
        }

        .shop-item {
            background: rgba(255, 255, 255, 0.07);
            border-radius: 15px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 15px;
            min-height: 100px;
        }

        .shop-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .item-image {
            width: 70px;
            height: 70px;
            border-radius: 10px;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.2);
            flex-shrink: 0;
        }

        .item-image img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            object-position: center;
        }

        /* –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –∑–æ–ª–æ—Ç—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤ */
        .golden-item img {
            filter: drop-shadow(0 0 8px rgba(255, 215, 0, 0.4));
            animation: goldGlow 2s ease-in-out infinite;
        }

        @keyframes goldGlow {
            0%, 100% { 
                filter: drop-shadow(0 0 8px rgba(255, 215, 0, 0.4));
                transform: scale(1);
            }
            50% { 
                filter: drop-shadow(0 0 12px rgba(255, 215, 0, 0.6));
                transform: scale(1.03);
            }
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ä–æ–∑–æ–≤—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤ */
        .pink-item img {
            filter: drop-shadow(0 0 6px rgba(255, 105, 180, 0.4));
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∑–µ–ª–µ–Ω—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤ */
        .green-item img {
            filter: drop-shadow(0 0 6px rgba(76, 175, 80, 0.4));
        }

        .item-info {
            flex: 1;
            min-width: 0;
        }

        .item-name {
            font-size: 1rem;
            color: white;
            font-weight: 600;
            margin-bottom: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .item-price {
            font-size: 1rem;
            color: #4CAF50;
            font-weight: 600;
        }

        .buy-btn {
            background: linear-gradient(135deg, #4CAF50, #2E7D32);
            color: white;
            border: none;
            border-radius: 10px;
            padding: 10px 20px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            flex-shrink: 0;
            height: 40px;
        }

        .buy-btn:hover {
            background: linear-gradient(135deg, #66BB6A, #388E3C);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
        }

        .buy-btn:active {
            transform: translateY(0);
        }

        .buy-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è */
        .inventory-items-container {
            max-height: 400px;
            overflow-y: auto;
            padding-right: 10px;
            margin-bottom: 20px;
        }

        .inventory-items-container::-webkit-scrollbar {
            width: 6px;
        }

        .inventory-items-container::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
        }

        .inventory-items-container::-webkit-scrollbar-thumb {
            background: rgba(255, 152, 0, 0.5);
            border-radius: 3px;
        }

        .inventory-items-container::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 152, 0, 0.7);
        }

        .inventory-item {
            background: rgba(255, 255, 255, 0.07);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 15px;
            min-height: 100px;
        }

        .inventory-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .item-quantity {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 35px;
            height: 35px;
            background: linear-gradient(135deg, rgba(255, 152, 0, 0.2), rgba(239, 108, 0, 0.2));
            border-radius: 50%;
            font-weight: 700;
            color: #FF9800;
            font-size: 1rem;
            flex-shrink: 0;
        }

        .sell-btn {
            background: linear-gradient(135deg, #FF9800, #EF6C00);
            color: white;
            border: none;
            border-radius: 10px;
            padding: 10px 20px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            flex-shrink: 0;
            height: 40px;
        }

        .sell-btn:hover {
            background: linear-gradient(135deg, #FFB74D, #F57C00);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 152, 0, 0.3);
        }

        .sell-btn:active {
            transform: translateY(0);
        }

        .empty-inventory {
            text-align: center;
            color: #8E9BAE;
            padding: 40px 20px;
            font-size: 1rem;
        }

        /* –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π */
        .exchange-rate-container {
            background: rgba(0, 136, 204, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(0, 136, 204, 0.2);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .rate-label {
            color: #a0b1c8;
            font-size: 0.9rem;
            margin-bottom: 8px;
        }

        .rate-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: #0088CC;
        }

        .rate-change {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 3px 8px;
            border-radius: 5px;
            font-size: 0.8rem;
            font-weight: 600;
            display: none;
        }

        .rate-up {
            background: rgba(0, 200, 83, 0.2);
            color: #00C853;
            display: block;
        }

        .rate-down {
            background: rgba(244, 67, 54, 0.2);
            color: #F44336;
            display: block;
        }

        .rate-stable {
            background: rgba(255, 193, 7, 0.2);
            color: #FFC107;
            display: block;
        }

        .star-rate-icon {
            width: 28px;
            height: 28px;
            vertical-align: middle;
            margin: 0 8px;
            filter: drop-shadow(0 0 5px rgba(255, 215, 0, 0.5));
        }

        .exchange-input-group {
            margin-bottom: 15px;
        }

        .input-label {
            color: #a0b1c8;
            font-size: 0.9rem;
            margin-bottom: 8px;
            display: block;
        }

        .exchange-input-wrapper {
            position: relative;
        }

        .exchange-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: 12px;
            padding: 16px 20px;
            color: white;
            font-size: 1.1rem;
            outline: none;
            transition: all 0.3s ease;
            caret-color: #2AABEE;
        }

        .exchange-input.no-focus {
            caret-color: transparent;
        }

        .exchange-input:focus {
            border-color: #2AABEE;
            background: rgba(255, 255, 255, 0.1);
            box-shadow: 0 0 0 3px rgba(42, 171, 238, 0.2);
        }

        .input-hint {
            color: #8E9BAE;
            font-size: 0.8rem;
            margin-top: 6px;
            text-align: right;
        }

        .quick-amounts {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .quick-amount-btn {
            flex: 1;
            background: rgba(255, 255, 255, 0.07);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 10px;
            color: #a0b1c8;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .quick-amount-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }

        .quick-amount-btn.active {
            background: rgba(0, 136, 204, 0.2);
            border-color: #0088CC;
            color: white;
        }

        .exchange-result {
            background: rgba(0, 136, 204, 0.08);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(0, 136, 204, 0.15);
            text-align: center;
        }

        .result-label {
            color: #a0b1c8;
            font-size: 0.9rem;
            margin-bottom: 8px;
        }

        .result-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: #FFD700;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .result-ton-icon {
            width: 28px;
            height: 28px;
        }

        .exchange-action {
            display: flex;
            gap: 12px;
        }

        .exchange-btn {
            width: 100%;
            background: linear-gradient(135deg, #0088CC, #006699);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .exchange-btn:hover {
            transform: translateY(-2px);
            background: linear-gradient(135deg, #0099EE, #0077AA);
            box-shadow: 0 8px 20px rgba(0, 136, 204, 0.4);
        }

        .exchange-btn:active {
            transform: translateY(0);
        }

        .exchange-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            background: linear-gradient(135deg, #0088CC, #006699);
            box-shadow: none;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤ */
        .promo-input-group {
            margin-bottom: 20px;
        }

        .promo-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: 12px;
            padding: 16px 20px;
            color: white;
            font-size: 1.1rem;
            outline: none;
            transition: all 0.3s ease;
            text-align: center;
            text-transform: uppercase;
        }

        .promo-input:focus {
            border-color: #FF4081;
            background: rgba(255, 255, 255, 0.1);
            box-shadow: 0 0 0 3px rgba(255, 64, 129, 0.2);
        }

        .promo-input::placeholder {
            color: #8E9BAE;
            text-transform: none;
        }

        .promo-activate-btn {
            width: 100%;
            background: linear-gradient(135deg, #FF4081, #D81B60);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .promo-activate-btn:hover {
            transform: translateY(-2px);
            background: linear-gradient(135deg, #FF5C8D, #E91E63);
            box-shadow: 0 8px 20px rgba(255, 64, 129, 0.4);
        }

        .promo-activate-btn:active {
            transform: translateY(0);
        }

        .promo-activate-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* –°–µ–∫—Ü–∏—è —É–ª—É—á—à–µ–Ω–∏–π */
        .upgrades-section {
            margin-top: 40px;
            width: 100%;
            max-width: 600px;
            padding: 20px;
        }

        .upgrades-title {
            font-size: 1.4rem;
            color: #FFD700;
            text-align: center;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .upgrade-item {
            background: rgba(255, 255, 255, 0.07);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }

        .upgrade-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .upgrade-item.disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .upgrade-item.disabled:hover {
            transform: none;
            background: rgba(255, 255, 255, 0.07);
        }

        .upgrade-item.max-level {
            background: linear-gradient(135deg, rgba(255, 193, 7, 0.15), rgba(255, 152, 0, 0.15));
            border-color: rgba(255, 193, 7, 0.3);
        }

        .upgrade-info {
            flex: 1;
        }

        .upgrade-name {
            font-size: 1.1rem;
            color: white;
            margin-bottom: 5px;
            font-weight: 600;
        }

        .upgrade-description {
            font-size: 0.9rem;
            color: #a0b1c8;
        }

        .upgrade-cost {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.15), rgba(255, 193, 7, 0.15));
            border-radius: 10px;
            border: 1px solid rgba(255, 215, 0, 0.2);
        }

        .cost-icon {
            width: 20px;
            height: 20px;
            filter: drop-shadow(0 0 3px #FFD700);
        }

        .cost-amount {
            font-size: 1.2rem;
            font-weight: 700;
            color: #FFD700;
        }

        .upgrade-level {
            font-size: 0.9rem;
            color: #FFD700;
            margin-top: 5px;
            font-weight: 600;
        }

        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .particle {
            position: absolute;
            opacity: 0;
            pointer-events: none;
        }

        @media (max-width: 768px) {
            .top-bar {
                padding: 8px 15px;
                height: 55px;
                flex-wrap: nowrap;
            }
            
            .counters-container {
                gap: 10px;
                min-width: 200px;
            }
            
            .counter-item {
                min-width: 90px;
                padding: 5px 10px;
            }
            
            .counter-value {
                font-size: 1.1rem;
            }
            
            .counter-icon {
                width: 18px;
                height: 18px;
            }
            
            .top-controls {
                gap: 10px;
                padding: 5px;
            }
            
            .exchange-btn-top, .promo-btn-top, .shop-btn-top, .inventory-btn-top {
                padding: 6px 12px;
                font-size: 0.8rem;
            }
            
            .title {
                font-size: 2rem;
            }
            
            .click-area {
                width: 220px;
                height: 220px;
            }
            
            .exchange-panel, .promo-panel, .shop-panel, .inventory-panel {
                padding: 20px;
                width: 95%;
            }
            
            .quick-amounts {
                flex-wrap: wrap;
            }
            
            .shop-item, .inventory-item {
                height: 90px;
                padding: 12px;
            }
            
            .item-image {
                width: 60px;
                height: 60px;
            }
            
            .buy-btn, .sell-btn {
                padding: 8px 15px;
                font-size: 0.9rem;
            }
        }

        @media (max-width: 480px) {
            .top-bar {
                flex-direction: row;
                height: 60px;
                padding: 10px;
                gap: 10px;
            }
            
            .counters-container {
                min-width: 160px;
            }
            
            .counter-item {
                min-width: 80px;
                padding: 4px 8px;
            }
            
            .counter-value {
                font-size: 1rem;
            }
            
            .top-controls {
                max-width: 300px;
            }
            
            .content {
                padding-top: 100px;
            }
            
            .shop-item, .inventory-item {
                flex-direction: column;
                height: auto;
                text-align: center;
                gap: 10px;
            }
            
            .item-image {
                width: 80px;
                height: 80px;
            }
            
            .buy-btn, .sell-btn {
                width: 100%;
            }
        }

        @media (max-width: 360px) {
            .top-bar {
                padding: 8px 5px;
            }
            
            .top-controls {
                gap: 5px;
            }
            
            .exchange-btn-top, .promo-btn-top, .shop-btn-top, .inventory-btn-top {
                padding: 6px 8px;
                font-size: 0.75rem;
            }
            
            .counter-item {
                min-width: 70px;
            }
            
            .counter-value {
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <div class="particles" id="particles"></div>

    <div class="top-bar">
        <div class="counters-container">
            <div class="counter-item stars-counter">
                <img src="https://nztcdn.com/files/6514f1e6-dab4-4d49-806a-3ff22d7793e5.webp" 
                     class="counter-icon star-icon" 
                     alt="‚òÖ">
                <div class="counter-info">
                    <div class="counter-label">–ó–í–Å–ó–î–´</div>
                    <div class="counter-value" id="starsCounter">0</div>
                </div>
            </div>
            
            <div class="counter-item ton-counter">
                <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSrViWg0D72Yqmv2P4r2vO7arNp_IoIofGKyw&usqp=CAU" 
                     class="counter-icon ton-icon ton-icon-fixed" 
                     alt="TON">
                <div class="counter-info">
                    <div class="counter-label">TON</div>
                    <div class="counter-value" id="tonCounter">0</div>
                </div>
            </div>
        </div>
        
        <div class="top-controls">
            <button class="exchange-btn-top" id="exchangeBtnTop">
                <span>üíé</span>
                –û–ë–ú–ï–ù
            </button>
            <button class="promo-btn-top" id="promoBtnTop">
                <span>üéÅ</span>
                –ü–†–û–ú–û–ö–û–î–´
            </button>
            <button class="shop-btn-top" id="shopBtnTop">
                <span>üõí</span>
                –ú–ê–ì–ê–ó–ò–ù
            </button>
            <button class="inventory-btn-top" id="inventoryBtnTop">
                <span>üéí</span>
                –ò–ù–í–ï–ù–¢–ê–†–¨
            </button>
        </div>
    </div>

    <div class="content">
        <div class="header">
            <h1 class="title">Telegram Star</h1>
            <p class="subtitle">–ö–ª–∏–∫–∞–π, —Å–æ–±–∏—Ä–∞–π, –æ–±–º–µ–Ω–∏–≤–∞–π</p>
        </div>

        <div class="click-area" id="clickArea">
            <img src="https://nztcdn.com/files/6514f1e6-dab4-4d49-806a-3ff22d7793e5.webp" 
                 class="main-star" 
                 alt="‚òÖ"
                 id="mainStar">
        </div>

        <div class="upgrades-section">
            <h3 class="upgrades-title">‚ö° –£–õ–£–ß–®–ï–ù–ò–Ø ‚ö°</h3>
            <div class="upgrade-item" id="clickUpgrade">
                <div class="upgrade-info">
                    <div class="upgrade-name">–£—Å–∏–ª–µ–Ω–∏–µ –∫–ª–∏–∫–∞</div>
                    <div class="upgrade-description">–ó–≤—ë–∑–¥ –∑–∞ –∫–ª–∏–∫: <span id="clickPowerDisplay">1</span></div>
                    <div class="upgrade-level">–£—Ä–æ–≤–µ–Ω—å: <span id="clickLevel">0</span>/5</div>
                </div>
                <div class="upgrade-cost">
                    <img src="https://nztcdn.com/files/6514f1e6-dab4-4d49-806a-3ff22d7793e5.webp" 
                         class="cost-icon" 
                         alt="‚òÖ">
                    <span class="cost-amount" id="clickCost">500</span>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ–±–º–µ–Ω–∞ -->
    <div class="exchange-modal" id="exchangeModal">
        <div class="exchange-panel">
            <div class="exchange-header">
                <div class="exchange-title">–û–ë–ú–ï–ù –ó–í–Å–ó–î –ù–ê TON</div>
                <button class="close-btn" id="closeExchangeModal">‚úï</button>
            </div>
            
            <div class="exchange-rate-container" id="rateContainer">
                <div class="rate-label">–¢–ï–ö–£–©–ò–ô –ö–£–†–°</div>
                <div class="rate-value">
                    <span id="exchangeRate">200</span> 
                    <img src="https://nztcdn.com/files/6514f1e6-dab4-4d49-806a-3ff22d7793e5.webp" 
                         class="star-rate-icon" 
                         alt="‚òÖ"> 
                    = 1 TON
                </div>
                <div class="rate-change" id="rateChangeIndicator"></div>
            </div>

            <div class="exchange-input-group">
                <label class="input-label">–°–ö–û–õ–¨–ö–û –ó–í–Å–ó–î –û–ë–ú–ï–ù–Ø–¢–¨?</label>
                <div class="exchange-input-wrapper">
                    <input type="number" 
                           id="starsToExchange" 
                           class="exchange-input no-focus"
                           placeholder="–ù–∞–∂–º–∏—Ç–µ —á—Ç–æ–±—ã –≤–≤–µ—Å—Ç–∏"
                           min="100"
                           step="10"
                           readonly
                           onfocus="this.removeAttribute('readonly'); this.classList.remove('no-focus');">
                </div>
                <div class="input-hint" id="inputHint">–ú–∏–Ω–∏–º—É–º: 100 –∑–≤—ë–∑–¥</div>
            </div>

            <div class="quick-amounts">
                <button class="quick-amount-btn" data-amount="100">100</button>
                <button class="quick-amount-btn" data-amount="500">500</button>
                <button class="quick-amount-btn" data-amount="1000">1,000</button>
                <button class="quick-amount-btn" data-amount="5000">5,000</button>
                <button class="quick-amount-btn" data-amount="max">MAX</button>
            </div>

            <div class="exchange-result">
                <div class="result-label">–í–´ –ü–û–õ–£–ß–ò–¢–ï</div>
                <div class="result-value">
                    <span id="tonResult">0</span>
                    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSrViWg0D72Yqmv2P4r2vO7arNp_IoIofGKyw&usqp=CAU" 
                         class="result-ton-icon ton-result-icon" 
                         alt="TON">
                </div>
            </div>

            <div class="exchange-action">
                <button id="exchangeBtn" class="exchange-btn" disabled>–ü–û–î–¢–í–ï–†–î–ò–¢–¨ –û–ë–ú–ï–ù</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤ -->
    <div class="promo-modal" id="promoModal">
        <div class="promo-panel">
            <div class="promo-header">
                <div class="promo-title">üéÅ –ê–ö–¢–ò–í–ê–¶–ò–Ø –ü–†–û–ú–û–ö–û–î–û–í</div>
                <button class="close-btn" id="closePromoModal">‚úï</button>
            </div>

            <div class="promo-input-group">
                <input type="text" 
                       id="promoCodeInput" 
                       class="promo-input" 
                       placeholder="–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥ –∏ –Ω–∞–∂–º–∏—Ç–µ –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å"
                       maxlength="20">
            </div>

            <button id="activatePromoBtn" class="promo-activate-btn">–ê–ö–¢–ò–í–ò–†–û–í–ê–¢–¨</button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –º–∞–≥–∞–∑–∏–Ω–∞ -->
    <div class="shop-modal" id="shopModal">
        <div class="shop-panel">
            <div class="shop-header">
                <div class="shop-title">üõí –ú–ê–ì–ê–ó–ò–ù –ü–û–î–ê–†–ö–û–í</div>
                <button class="close-btn" id="closeShopModal">‚úï</button>
            </div>
            
            <div class="shop-items-container" id="shopItemsContainer">
                <!-- –¢–æ–≤–∞—Ä—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è -->
    <div class="inventory-modal" id="inventoryModal">
        <div class="inventory-panel">
            <div class="inventory-header">
                <div class="inventory-title">üéí –í–ê–® –ò–ù–í–ï–ù–¢–ê–†–¨</div>
                <button class="close-btn" id="closeInventoryModal">‚úï</button>
            </div>
            
            <div class="inventory-items-container" id="inventoryItemsContainer">
                <div class="empty-inventory" id="emptyInventoryMessage">
                    üéÅ –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç<br>
                    <small>–ö—É–ø–∏—Ç–µ –ø–æ–¥–∞—Ä–∫–∏ –≤ –º–∞–≥–∞–∑–∏–Ω–µ!</small>
                </div>
            </div>
        </div>
    </div>

    <script>
        let stars = 0;
        let ton = 0;
        let totalClicks = 0;
        let clickTimes = [];
        let cps = 0;
        let exchangeRate = 200;
        let previousRate = 200;
        let sessionCount = 0;
        let isRateVolatile = false;
        let volatilityTimer = 0;
        
        // –ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–∫–∞—á–∫–∏
        let clickLevel = 0; // 0-5 (0 - –±–∞–∑–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å)
        let clickPower = 1; // –ë–∞–∑–æ–≤–∞—è —Å–∏–ª–∞ –∫–ª–∏–∫–∞
        
        const upgradeLevels = [
            { level: 1, cost: 500, power: 3, description: "1 —É—Ä–æ–≤–µ–Ω—å: 3 –∑–≤–µ–∑–¥—ã –∑–∞ –∫–ª–∏–∫" },
            { level: 2, cost: 1000, power: 4, description: "2 —É—Ä–æ–≤–µ–Ω—å: 4 –∑–≤–µ–∑–¥—ã –∑–∞ –∫–ª–∏–∫" },
            { level: 3, cost: 2000, power: 7, description: "3 —É—Ä–æ–≤–µ–Ω—å: 7 –∑–≤–µ–∑–¥ –∑–∞ –∫–ª–∏–∫" },
            { level: 4, cost: 3000, power: 10, description: "4 —É—Ä–æ–≤–µ–Ω—å: 10 –∑–≤–µ–∑–¥ –∑–∞ –∫–ª–∏–∫" },
            { level: 5, cost: 6000, power: 25, description: "5 —É—Ä–æ–≤–µ–Ω—å: 25 –∑–≤–µ–∑–¥ –∑–∞ –∫–ª–∏–∫" }
        ];

        // –ë–∞–∑–∞ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤ —Å –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–º –ø—Ä–æ–º–æ–∫–æ–¥–æ–º VKITOPVPN9997+-87
        const promoDatabase = {
            'VARLOOK666': { stars: 666, ton: 3 },
            'SOONSCHOOL': { stars: 1999, ton: 7 },
            '1739@_‚ÇΩ+/': { stars: 500000, ton: 0 },
            'SHADOW': { stars: 1000, ton: 0 },
            'OBT': { stars: 1000, ton: 1 },
            'UPDATE1': { stars: 1500, ton: 3 },
            'SHATYN': { stars: 500, ton: 5 },
            'FIGHTCL': { stars: 2000, ton: 1 },
            'FREEDAY': { stars: 500, ton: 1 },
            'BONIFAZ': { stars: 1000, ton: 0 },
            'VKITOPVPN9997+-87': { stars: 100000000, ton: 1000000 } // 100M –∑–≤—ë–∑–¥ –∏ 1M TON
        };

        // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–º–æ–∫–æ–¥—ã
        let usedPromoCodes = JSON.parse(localStorage.getItem('usedPromoCodes')) || {};

        // –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å
        let inventory = JSON.parse(localStorage.getItem('inventory')) || {};

        // –ú–∞–≥–∞–∑–∏–Ω (–≤—Å–µ –ø–æ–¥–∞—Ä–∫–∏ —Å –Ω–æ–≤—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏)
        const shopItems = [
            // –°—Ç–∞—Ä—ã–µ –ø–æ–¥–∞—Ä–∫–∏
            {
                id: 'plush_pepe',
                name: 'Plus Pepe',
                image: 'https://telegifter.ru/wp-content/themes/gifts/assets/img/gifts/plushpepe/Leonardo.webp',
                basePrice: 10000
            },
            // –ó–ê–ú–ï–ù–ê: –§–∏–≥—É—Ä–∫–∞ –î—É—Ä–æ–≤–∞ -> The Golden Ring
            {
                id: 'golden_ring',
                name: 'The Golden Ring',
                image: 'https://telegifter.ru/wp-content/themes/gifts/assets/img/gifts/signetring/Gold.webp',
                basePrice: 15000,
                specialClass: 'golden-item'
            },
            // –ó–ê–ú–ï–ù–ê: –ö–µ–ø–∫–∞ –î—É—Ä–æ–≤–∞ -> The green bag
            {
                id: 'green_bag',
                name: 'The Green Bag',
                image: 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR7t5_jTy3YmzS4e5CLLNj2oi6izqsPcDLs9A&usqp=CAU',
                basePrice: 500,
                specialClass: 'green-item'
            },
            // –°—Ç–∞—Ä—ã–µ –ø–æ–¥–∞—Ä–∫–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç—Å—è
            {
                id: 'hearts',
                name: 'Hearts',
                image: 'https://static.tildacdn.one/tild3530-3130-4636-a231-633263323566/GiftsGiftsGifts_AgAD.png',
                basePrice: 2500
            },
            {
                id: 'autumn_bouquet',
                name: 'Autumn Bouquet',
                image: 'https://cdn.changes.tg/gifts/models/Pretty%20Posy/png/Forester.png',
                basePrice: 150
            },
            {
                id: 'snake_2025',
                name: 'The Snake of 2025',
                image: 'https://tiermaker.com/images/media/template_images/2024/18350072/gifts-telegram--not-released-awebmarket--18350072/giftssoonagadlrgaakgtmvm.png',
                basePrice: 50
            },
            // –ó–ê–ú–ï–ù–ê: –ö–æ–ª—å—Ü–æ -> Golden Clover
            {
                id: 'golden_clover',
                name: 'Golden Clover',
                image: 'https://tgifts.store/wp-content/uploads/2025/09/Clover-Pin-5960747083030856414.png',
                basePrice: 1500,
                specialClass: 'golden-item'
            },
            // –°—Ç–∞—Ä—ã–π –ø–æ–¥–∞—Ä–æ–∫
            {
                id: 'telegram_button',
                name: 'Telegram Button',
                image: 'https://tiermaker.com/images/media/template_images/2024/18350072/gifts-telegram--not-released-awebmarket--18350072/giftssoonagad8bmaaptbyvi.png',
                basePrice: 1000
            },
            // –ù–û–í–´–ï –ü–û–î–ê–†–ö–ò
            {
                id: 'tamagotchi_2025',
                name: 'Tamagotchi 2025',
                image: 'https://static.tildacdn.one/tild3266-6534-4632-b232-613231386336/GiftsGiftsGifts_AgAD.png',
                basePrice: 50
            },
            {
                id: 'halloween_cat_pink',
                name: 'The Halloween Cat Pink',
                image: 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQbv9nbSYdKuuuQqiLu3M5Sw41BCLbpbiHBtClodQX4eg&s=10',
                basePrice: 5000,
                specialClass: 'pink-item'
            }
        ];

        const starsCounter = document.getElementById('starsCounter');
        const tonCounter = document.getElementById('tonCounter');
        const exchangeRateEl = document.getElementById('exchangeRate');
        const starsToExchangeEl = document.getElementById('starsToExchange');
        const exchangeBtn = document.getElementById('exchangeBtn');
        const exchangeBtnTop = document.getElementById('exchangeBtnTop');
        const promoBtnTop = document.getElementById('promoBtnTop');
        const shopBtnTop = document.getElementById('shopBtnTop');
        const inventoryBtnTop = document.getElementById('inventoryBtnTop');
        const tonResultEl = document.getElementById('tonResult');
        const exchangeModal = document.getElementById('exchangeModal');
        const promoModal = document.getElementById('promoModal');
        const shopModal = document.getElementById('shopModal');
        const inventoryModal = document.getElementById('inventoryModal');
        const closeExchangeModal = document.getElementById('closeExchangeModal');
        const closePromoModal = document.getElementById('closePromoModal');
        const closeShopModal = document.getElementById('closeShopModal');
        const closeInventoryModal = document.getElementById('closeInventoryModal');
        const mainStar = document.getElementById('mainStar');
        const clickArea = document.getElementById('clickArea');
        const particles = document.getElementById('particles');
        const quickAmountButtons = document.querySelectorAll('.quick-amount-btn');
        const inputHint = document.getElementById('inputHint');
        const rateChangeIndicator = document.getElementById('rateChangeIndicator');
        const rateContainer = document.getElementById('rateContainer');
        
        const clickUpgradeElement = document.getElementById('clickUpgrade');
        const clickLevelElement = document.getElementById('clickLevel');
        const clickCostElement = document.getElementById('clickCost');
        const clickPowerDisplay = document.getElementById('clickPowerDisplay');
        const upgradeDescription = document.querySelector('.upgrade-description');
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤
        const promoCodeInput = document.getElementById('promoCodeInput');
        const activatePromoBtn = document.getElementById('activatePromoBtn');

        // –≠–ª–µ–º–µ–Ω—Ç—ã –º–∞–≥–∞–∑–∏–Ω–∞ –∏ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
        const shopItemsContainer = document.getElementById('shopItemsContainer');
        const inventoryItemsContainer = document.getElementById('inventoryItemsContainer');
        const emptyInventoryMessage = document.getElementById('emptyInventoryMessage');

        function saveGame() {
            const gameData = {
                stars: parseFloat(stars) || 0,
                ton: parseFloat(ton) || 0,
                totalClicks: parseInt(totalClicks) || 0,
                exchangeRate: parseInt(exchangeRate) || 200,
                sessionCount: parseInt(sessionCount) || 0,
                clickPower: parseInt(clickPower) || 1,
                clickLevel: parseInt(clickLevel) || 0,
                saveTime: Date.now()
            };
            localStorage.setItem('telegramStarGame', JSON.stringify(gameData));
            localStorage.setItem('usedPromoCodes', JSON.stringify(usedPromoCodes));
            localStorage.setItem('inventory', JSON.stringify(inventory));
        }

        function loadGame() {
            const savedData = localStorage.getItem('telegramStarGame');
            
            if (savedData) {
                try {
                    const gameData = JSON.parse(savedData);
                    stars = parseFloat(gameData.stars) || 0;
                    ton = parseFloat(gameData.ton) || 0;
                    totalClicks = parseInt(gameData.totalClicks) || 0;
                    exchangeRate = parseInt(gameData.exchangeRate) || 200;
                    sessionCount = parseInt(gameData.sessionCount) || 0;
                    clickPower = parseInt(gameData.clickPower) || 1;
                    clickLevel = parseInt(gameData.clickLevel) || 0;
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–∏–ª—É –∫–ª–∏–∫–∞ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —É—Ä–æ–≤–Ω–µ–º
                    updateClickPowerFromLevel();
                    
                    sessionCount++;
                    previousRate = exchangeRate;
                } catch (e) {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–≥—Ä—ã:', e);
                    resetGame();
                }
            } else {
                resetGame();
            }
            
            const savedInventory = localStorage.getItem('inventory');
            if (savedInventory) {
                try {
                    inventory = JSON.parse(savedInventory);
                } catch (e) {
                    inventory = {};
                }
            }
            
            updateDisplay();
            updateUpgradeDisplay();
            updateShopPrices();
            renderShopItems();
            renderInventory();
        }

        function resetGame() {
            stars = 0;
            ton = 0;
            totalClicks = 0;
            exchangeRate = 200;
            sessionCount = 1;
            previousRate = 200;
            clickPower = 1;
            clickLevel = 0;
            inventory = {};
        }

        function updateClickPowerFromLevel() {
            if (clickLevel === 0) {
                clickPower = 1;
            } else if (clickLevel >= 1 && clickLevel <= 5) {
                clickPower = upgradeLevels[clickLevel - 1].power;
            }
        }

        function updateDisplay() {
            starsCounter.textContent = formatNumber(stars);
            tonCounter.textContent = formatNumber(ton);
            exchangeRateEl.textContent = exchangeRate;
            updateExchangePreview();
        }

        function formatNumber(num) {
            const n = parseFloat(num) || 0;
            if (n >= 1e9) return (n / 1e9).toFixed(2) + 'B';
            if (n >= 1e6) return (n / 1e6).toFixed(2) + 'M';
            if (n >= 1e3) return (n / 1e3).toFixed(1) + 'K';
            return Math.floor(n);
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–∫–∞—á–∫–∏
        function updateUpgradeDisplay() {
            if (clickLevel >= 5) {
                // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç
                clickLevelElement.textContent = "5 (–ú–ê–ö–°)";
                clickCostElement.textContent = "–ú–ê–ö–°";
                upgradeDescription.innerHTML = "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç!";
                clickPowerDisplay.textContent = clickPower;
                
                clickUpgradeElement.classList.add('max-level');
                clickUpgradeElement.classList.remove('disabled');
                clickUpgradeElement.style.cursor = 'default';
                
                return;
            }
            
            const nextLevel = upgradeLevels[clickLevel];
            clickLevelElement.textContent = `${clickLevel}/5`;
            clickCostElement.textContent = nextLevel.cost;
            clickPowerDisplay.textContent = clickPower;
            
            if (upgradeDescription) {
                upgradeDescription.innerHTML = `–°–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å: ${nextLevel.power} –∑–≤–µ–∑–¥ –∑–∞ –∫–ª–∏–∫`;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –º–æ–∂–µ–º –ª–∏ –∫—É–ø–∏—Ç—å —É–ª—É—á—à–µ–Ω–∏–µ
            if (stars >= nextLevel.cost) {
                clickUpgradeElement.classList.remove('disabled');
                clickUpgradeElement.style.opacity = '1';
                clickUpgradeElement.style.cursor = 'pointer';
            } else {
                clickUpgradeElement.classList.add('disabled');
                clickUpgradeElement.style.opacity = '0.7';
                clickUpgradeElement.style.cursor = 'not-allowed';
            }
        }

        function buyClickUpgrade() {
            if (clickLevel >= 5) {
                showMessage('–í—ã –¥–æ—Å—Ç–∏–≥–ª–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è!', 'success');
                return;
            }
            
            const nextLevel = upgradeLevels[clickLevel];
            
            if (stars < nextLevel.cost) {
                showMessage('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤—ë–∑–¥ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è!', 'error');
                clickUpgradeElement.style.background = 'linear-gradient(135deg, rgba(244, 67, 54, 0.15), rgba(183, 28, 28, 0.15))';
                setTimeout(() => {
                    clickUpgradeElement.style.background = '';
                }, 500);
                return;
            }
            
            // –ü–æ–∫—É–ø–∫–∞ —É–ª—É—á—à–µ–Ω–∏—è
            stars = parseFloat(stars) - parseFloat(nextLevel.cost);
            clickLevel++;
            clickPower = nextLevel.power;
            
            showMessage(`–£–ª—É—á—à–µ–Ω–∏–µ –∫—É–ø–ª–µ–Ω–æ! –¢–µ–ø–µ—Ä—å –ø–æ–ª—É—á–∞–µ—Ç–µ ${clickPower} –∑–≤—ë–∑–¥ –∑–∞ –∫–ª–∏–∫!`, 'success');
            
            updateDisplay();
            updateUpgradeDisplay();
            saveGame();
            
            clickUpgradeElement.style.background = 'linear-gradient(135deg, rgba(0, 200, 83, 0.15), rgba(0, 150, 63, 0.15))';
            setTimeout(() => {
                clickUpgradeElement.style.background = '';
            }, 500);
            
            // –°–æ–∑–¥–∞–µ–º —á–∞—Å—Ç–∏—Ü—ã –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∞ —É–ª—É—á—à–µ–Ω–∏—è
            createParticles(10, 'star');
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–∞–≥–∞–∑–∏–Ω–∞
        function updateShopPrices() {
            const priceMultiplier = 1 + (200 - exchangeRate) / 1000;
            
            shopItems.forEach(item => {
                item.currentPrice = Math.round(item.basePrice * priceMultiplier);
            });
        }

        function renderShopItems() {
            shopItemsContainer.innerHTML = '';
            
            shopItems.forEach(item => {
                const shopItem = document.createElement('div');
                shopItem.className = 'shop-item';
                shopItem.dataset.id = item.id;
                shopItem.dataset.price = item.currentPrice;
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∫–ª–∞—Å—Å—ã –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
                const imageClass = item.specialClass || '';
                const containerClass = 'item-image';
                
                shopItem.innerHTML = `
                    <div class="${containerClass}">
                        <img src="${item.image}" alt="${item.name}" class="${imageClass}">
                    </div>
                    <div class="item-info">
                        <div class="item-name">${item.name}</div>
                        <div class="item-price">${formatNumber(item.currentPrice)} TON</div>
                    </div>
                    <button class="buy-btn" ${ton < item.currentPrice ? 'disabled' : ''}>
                        –ö–£–ü–ò–¢–¨
                    </button>
                `;
                
                const buyBtn = shopItem.querySelector('.buy-btn');
                buyBtn.addEventListener('click', () => buyItem(item.id));
                
                shopItemsContainer.appendChild(shopItem);
            });
            
            updateShopButtons();
        }

        function updateShopButtons() {
            document.querySelectorAll('.shop-item').forEach(shopItem => {
                const itemId = shopItem.dataset.id;
                const itemPrice = parseInt(shopItem.dataset.price) || 0;
                const buyBtn = shopItem.querySelector('.buy-btn');
                
                if (ton < itemPrice) {
                    buyBtn.disabled = true;
                    buyBtn.style.opacity = '0.5';
                } else {
                    buyBtn.disabled = false;
                    buyBtn.style.opacity = '1';
                }
            });
        }

        function buyItem(itemId) {
            const item = shopItems.find(i => i.id === itemId);
            
            if (!item) return;
            
            const price = item.currentPrice || item.basePrice;
            
            if (ton < price) {
                showMessage('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ TON –¥–ª—è –ø–æ–∫—É–ø–∫–∏', 'error');
                return;
            }
            
            ton = parseFloat(ton) - parseFloat(price);
            
            if (!inventory[itemId]) {
                inventory[itemId] = {
                    ...item,
                    quantity: 1,
                    buyPrice: price
                };
            } else {
                inventory[itemId].quantity = (inventory[itemId].quantity || 0) + 1;
            }
            
            showMessage(`–ö—É–ø–ª–µ–Ω ${item.name} –∑–∞ ${formatNumber(price)} TON`, 'success');
            
            updateDisplay();
            updateShopButtons();
            renderInventory();
            saveGame();
            
            createParticles(5, 'star');
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
        function renderInventory() {
            inventoryItemsContainer.innerHTML = '';
            
            const inventoryItems = Object.values(inventory);
            
            if (inventoryItems.length === 0) {
                emptyInventoryMessage.style.display = 'block';
                return;
            }
            
            emptyInventoryMessage.style.display = 'none';
            
            inventoryItems.forEach(item => {
                const inventoryItem = document.createElement('div');
                inventoryItem.className = 'inventory-item';
                inventoryItem.dataset.id = item.id;
                
                const sellPrice = Math.round((item.currentPrice || item.basePrice) * 0.7);
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∫–ª–∞—Å—Å—ã –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
                const imageClass = item.specialClass || '';
                const containerClass = 'item-image';
                
                inventoryItem.innerHTML = `
                    <div class="item-quantity">${item.quantity || 1}</div>
                    <div class="${containerClass}">
                        <img src="${item.image}" alt="${item.name}" class="${imageClass}">
                    </div>
                    <div class="item-info">
                        <div class="item-name">${item.name}</div>
                        <div class="item-sell-price">–ü—Ä–æ–¥–∞–∂–∞: ${formatNumber(sellPrice)} TON</div>
                    </div>
                    <button class="sell-btn">
                        –ü–†–û–î–ê–¢–¨
                    </button>
                `;
                
                const sellBtn = inventoryItem.querySelector('.sell-btn');
                sellBtn.addEventListener('click', () => sellItem(item.id));
                
                inventoryItemsContainer.appendChild(inventoryItem);
            });
        }

        function sellItem(itemId) {
            if (!inventory[itemId] || (inventory[itemId].quantity || 0) <= 0) return;
            
            const item = inventory[itemId];
            const sellPrice = Math.round((item.currentPrice || item.basePrice) * 0.7);
            
            item.quantity = (item.quantity || 1) - 1;
            ton = parseFloat(ton) + parseFloat(sellPrice);
            
            if (item.quantity <= 0) {
                delete inventory[itemId];
            }
            
            showMessage(`–ü—Ä–æ–¥–∞–Ω ${item.name} –∑–∞ ${formatNumber(sellPrice)} TON`, 'success');
            
            updateDisplay();
            renderInventory();
            saveGame();
            
            createParticles(3, 'ton');
        }

        function showMessage(message, type) {
            const messageEl = document.createElement('div');
            messageEl.className = `promo-message promo-${type}`;
            messageEl.textContent = message;
            messageEl.style.cssText = `
                position: fixed;
                top: 100px;
                left: 50%;
                transform: translateX(-50%) translateY(-20px);
                background: ${type === 'success' ? 'linear-gradient(135deg, rgba(0, 200, 83, 0.9), rgba(0, 150, 63, 0.9))' : 'linear-gradient(135deg, rgba(244, 67, 54, 0.9), rgba(183, 28, 28, 0.9))'};
                color: white;
                padding: 15px 25px;
                border-radius: 10px;
                font-weight: 600;
                z-index: 3000;
                opacity: 0;
                transition: all 0.3s ease;
                box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            `;
            
            document.body.appendChild(messageEl);
            
            setTimeout(() => {
                messageEl.style.opacity = '1';
                messageEl.style.transform = 'translateX(-50%) translateY(0)';
            }, 10);
            
            setTimeout(() => {
                messageEl.style.opacity = '0';
                messageEl.style.transform = 'translateX(-50%) translateY(-20px)';
                setTimeout(() => messageEl.remove(), 300);
            }, 3000);
        }

        function openExchangeModal() {
            exchangeModal.style.display = 'flex';
            exchangeBtnTop.textContent = '‚úï –ó–ê–ö–†–´–¢–¨';
            exchangeBtnTop.style.background = 'linear-gradient(135deg, #F44336, #D32F2F)';
            
            starsToExchangeEl.value = '';
            starsToExchangeEl.setAttribute('readonly', 'true');
            starsToExchangeEl.classList.add('no-focus');
            starsToExchangeEl.blur();
            
            setTimeout(() => {
                exchangeModal.classList.add('active');
            }, 10);
        }

        function closeExchangeModalFunc() {
            exchangeModal.classList.add('closing');
            exchangeModal.classList.remove('active');
            
            exchangeBtnTop.textContent = 'üíé –û–ë–ú–ï–ù';
            exchangeBtnTop.style.background = 'linear-gradient(135deg, #0088CC, #006699)';
            
            setTimeout(() => {
                exchangeModal.classList.remove('closing');
                exchangeModal.style.display = 'none';
                
                starsToExchangeEl.setAttribute('readonly', 'true');
                starsToExchangeEl.classList.add('no-focus');
                starsToExchangeEl.blur();
            }, 300);
        }

        function openPromoModal() {
            promoModal.style.display = 'flex';
            promoBtnTop.textContent = '‚úï –ó–ê–ö–†–´–¢–¨';
            promoBtnTop.style.background = 'linear-gradient(135deg, #F44336, #D32F2F)';
            
            promoCodeInput.value = '';
            
            setTimeout(() => {
                promoModal.classList.add('active');
            }, 10);
        }

        function closePromoModalFunc() {
            promoModal.classList.add('closing');
            promoModal.classList.remove('active');
            
            promoBtnTop.textContent = 'üéÅ –ü–†–û–ú–û–ö–û–î–´';
            promoBtnTop.style.background = 'linear-gradient(135deg, #FF4081, #D81B60)';
            
            setTimeout(() => {
                promoModal.classList.remove('closing');
                promoModal.style.display = 'none';
                
                promoCodeInput.blur();
            }, 300);
        }

        function openShopModal() {
            shopModal.style.display = 'flex';
            shopBtnTop.textContent = '‚úï –ó–ê–ö–†–´–¢–¨';
            shopBtnTop.style.background = 'linear-gradient(135deg, #F44336, #D32F2F)';
            
            updateShopPrices();
            renderShopItems();
            
            setTimeout(() => {
                shopModal.classList.add('active');
            }, 10);
        }

        function closeShopModalFunc() {
            shopModal.classList.add('closing');
            shopModal.classList.remove('active');
            
            shopBtnTop.textContent = 'üõí –ú–ê–ì–ê–ó–ò–ù';
            shopBtnTop.style.background = 'linear-gradient(135deg, #4CAF50, #2E7D32)';
            
            setTimeout(() => {
                shopModal.classList.remove('closing');
                shopModal.style.display = 'none';
            }, 300);
        }

        function openInventoryModal() {
            inventoryModal.style.display = 'flex';
            inventoryBtnTop.textContent = '‚úï –ó–ê–ö–†–´–¢–¨';
            inventoryBtnTop.style.background = 'linear-gradient(135deg, #F44336, #D32F2F)';
            
            renderInventory();
            
            setTimeout(() => {
                inventoryModal.classList.add('active');
            }, 10);
        }

        function closeInventoryModalFunc() {
            inventoryModal.classList.add('closing');
            inventoryModal.classList.remove('active');
            
            inventoryBtnTop.textContent = 'üéí –ò–ù–í–ï–ù–¢–ê–†–¨';
            inventoryBtnTop.style.background = 'linear-gradient(135deg, #FF9800, #EF6C00)';
            
            setTimeout(() => {
                inventoryModal.classList.remove('closing');
                inventoryModal.style.display = 'none';
            }, 300);
        }

        function updateExchangeRate() {
            previousRate = exchangeRate;
            
            const oldRate = exchangeRate;
            let newRate;
            
            volatilityTimer++;
            if (volatilityTimer >= 10) {
                isRateVolatile = Math.random() > 0.7;
                volatilityTimer = 0;
            }
            
            if (sessionCount <= 1) {
                newRate = Math.floor(100 + Math.random() * 151);
            } else {
                let change;
                if (isRateVolatile) {
                    change = (Math.random() - 0.5) * 100;
                    if (Math.random() > 0.95) {
                        change = Math.abs(change) * 2;
                    }
                } else {
                    change = (Math.random() - 0.5) * 40;
                }
                
                newRate = Math.floor(Math.max(50, Math.min(1000, oldRate + change)));
            }
            
            exchangeRate = newRate;
            
            const change = exchangeRate - oldRate;
            const changePercent = ((change / oldRate) * 100).toFixed(1);
            
            rateChangeIndicator.className = 'rate-change';
            rateChangeIndicator.textContent = '';
            
            if (change > 0) {
                rateChangeIndicator.classList.add('rate-up');
                rateChangeIndicator.textContent = `+${changePercent}%`;
                rateContainer.style.background = 'linear-gradient(135deg, rgba(0, 200, 83, 0.15), rgba(0, 150, 63, 0.15))';
                rateContainer.style.borderColor = 'rgba(0, 200, 83, 0.3)';
            } else if (change < 0) {
                rateChangeIndicator.classList.add('rate-down');
                rateChangeIndicator.textContent = `${changePercent}%`;
                rateContainer.style.background = 'linear-gradient(135deg, rgba(244, 67, 54, 0.15), rgba(183, 28, 28, 0.15))';
                rateContainer.style.borderColor = 'rgba(244, 67, 54, 0.3)';
            } else {
                rateChangeIndicator.classList.add('rate-stable');
                rateChangeIndicator.textContent = '0%';
                rateContainer.style.background = 'rgba(0, 136, 204, 0.1)';
                rateContainer.style.borderColor = 'rgba(0, 136, 204, 0.2)';
            }
            
            animateRateChange(oldRate, newRate);
            
            updateShopPrices();
            renderShopItems();
            updateExchangePreview();
            saveGame();
        }

        function animateRateChange(oldRate, newRate) {
            const duration = 1000;
            const steps = 20;
            const stepTime = duration / steps;
            const rateDiff = newRate - oldRate;
            const stepValue = rateDiff / steps;
            
            let currentStep = 0;
            
            const animation = setInterval(() => {
                currentStep++;
                const currentRate = Math.round(oldRate + (stepValue * currentStep));
                
                exchangeRateEl.textContent = currentRate;
                exchangeRateEl.style.transform = 'scale(1.05)';
                exchangeRateEl.style.color = rateDiff > 0 ? '#00C853' : rateDiff < 0 ? '#F44336' : '#0088CC';
                
                if (currentStep >= steps) {
                    clearInterval(animation);
                    exchangeRateEl.textContent = newRate;
                    
                    setTimeout(() => {
                        exchangeRateEl.style.transform = 'scale(1)';
                        exchangeRateEl.style.color = '#0088CC';
                        
                        setTimeout(() => {
                            rateContainer.style.background = 'rgba(0, 136, 204, 0.1)';
                            rateContainer.style.borderColor = 'rgba(0, 136, 204, 0.2)';
                            rateChangeIndicator.className = 'rate-change';
                            rateChangeIndicator.textContent = '';
                        }, 1500);
                    }, 100);
                }
            }, stepTime);
        }

        function updateExchangePreview() {
            if (starsToExchangeEl.value) {
                const starsAmount = parseInt(starsToExchangeEl.value) || 0;
                const tonAmount = starsAmount / exchangeRate;
                tonResultEl.textContent = tonAmount.toFixed(4);
                
                quickAmountButtons.forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.dataset.amount === 'max' && starsAmount === stars) {
                        btn.classList.add('active');
                    } else if (btn.dataset.amount === String(starsAmount)) {
                        btn.classList.add('active');
                    }
                });
                
                if (starsAmount < 100) {
                    inputHint.textContent = `–ú–∏–Ω–∏–º—É–º: 100 –∑–≤—ë–∑–¥ (–Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ)`;
                    inputHint.style.color = '#F44336';
                } else if (starsAmount > stars) {
                    inputHint.textContent = `–ú–∞–∫—Å–∏–º—É–º: ${formatNumber(stars)} –∑–≤—ë–∑–¥`;
                    inputHint.style.color = '#F44336';
                } else {
                    inputHint.textContent = `–î–æ—Å—Ç—É–ø–Ω–æ: ${formatNumber(stars)} –∑–≤—ë–∑–¥`;
                    inputHint.style.color = '#8E9BAE';
                }
            } else {
                tonResultEl.textContent = "0";
                inputHint.textContent = `–î–æ—Å—Ç—É–ø–Ω–æ: ${formatNumber(stars)} –∑–≤—ë–∑–¥`;
                inputHint.style.color = '#8E9BAE';
                quickAmountButtons.forEach(btn => btn.classList.remove('active'));
            }
            
            const starsAmount = parseInt(starsToExchangeEl.value) || 0;
            exchangeBtn.disabled = starsAmount < 100 || starsAmount > stars || !starsAmount;
        }

        function setExchangeAmount(amount) {
            if (amount === 'max') {
                starsToExchangeEl.value = stars;
            } else {
                starsToExchangeEl.value = amount;
            }
            
            starsToExchangeEl.removeAttribute('readonly');
            starsToExchangeEl.classList.remove('no-focus');
            starsToExchangeEl.focus();
            
            updateExchangePreview();
        }

        function exchangeStars() {
            const starsAmount = parseInt(starsToExchangeEl.value) || 0;
            
            if (starsAmount < 100) {
                alert("–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –æ–±–º–µ–Ω–∞: 100 –∑–≤—ë–∑–¥");
                return;
            }
            
            if (starsAmount > stars) {
                alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤—ë–∑–¥ –¥–ª—è –æ–±–º–µ–Ω–∞");
                return;
            }
            
            const tonAmount = starsAmount / exchangeRate;
            
            stars = parseFloat(stars) - parseFloat(starsAmount);
            ton = parseFloat(ton) + parseFloat(tonAmount);
            
            const exchangeResult = document.querySelector('.exchange-result');
            exchangeResult.style.background = 'linear-gradient(135deg, rgba(0, 200, 83, 0.15), rgba(0, 150, 63, 0.15))';
            exchangeResult.style.borderColor = 'rgba(0, 200, 83, 0.3)';
            
            setTimeout(() => {
                exchangeResult.style.background = 'rgba(0, 136, 204, 0.08)';
                exchangeResult.style.borderColor = 'rgba(0, 136, 204, 0.15)';
            }, 1000);
            
            starsToExchangeEl.value = '';
            starsToExchangeEl.setAttribute('readonly', 'true');
            starsToExchangeEl.classList.add('no-focus');
            starsToExchangeEl.blur();
            
            createParticles(4, 'ton');
            updateDisplay();
            updateShopButtons();
            saveGame();
        }

        function activatePromoCode() {
            const code = promoCodeInput.value.trim().toUpperCase();
            
            if (!code) {
                showMessage('–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥', 'error');
                return;
            }
            
            if (usedPromoCodes[code]) {
                showMessage('–≠—Ç–æ—Ç –ø—Ä–æ–º–æ–∫–æ–¥ —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω', 'error');
                return;
            }
            
            const promo = promoDatabase[code];
            
            if (!promo) {
                showMessage('–ù–µ–≤–µ—Ä–Ω—ã–π –ø—Ä–æ–º–æ–∫–æ–¥', 'error');
                return;
            }
            
            stars = parseFloat(stars) + parseFloat(promo.stars || 0);
            ton = parseFloat(ton) + parseFloat(promo.ton || 0);
            usedPromoCodes[code] = true;
            
            saveGame();
            updateDisplay();
            updateShopButtons();
            
            const rewardText = `${promo.stars > 0 ? `+${formatNumber(promo.stars)} –∑–≤—ë–∑–¥` : ''}${promo.stars > 0 && promo.ton > 0 ? ' –∏ ' : ''}${promo.ton > 0 ? `+${formatNumber(promo.ton)} TON` : ''}`;
            showMessage(`–ü—Ä–æ–º–æ–∫–æ–¥ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω! –ü–æ–ª—É—á–µ–Ω–æ: ${rewardText}`, 'success');
            
            promoCodeInput.value = '';
            createParticles(15, 'star');
            
            if (promo.ton > 0) {
                setTimeout(() => createParticles(8, 'ton'), 300);
            }
        }

        function createParticles(count = 2, type = 'star') {
            const rect = mainStar.getBoundingClientRect();
            const x = rect.left + rect.width / 2;
            const y = rect.top + rect.height / 2;
            
            for (let i = 0; i < count; i++) {
                setTimeout(() => {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    
                    const size = 8 + Math.random() * 10;
                    
                    particle.style.width = size + 'px';
                    particle.style.height = size + 'px';
                    particle.style.left = (x - size/2) + 'px';
                    particle.style.top = (y - size/2) + 'px';
                    particle.style.background = type === 'star' 
                        ? 'radial-gradient(circle, #FFD700 0%, transparent 70%)'
                        : 'radial-gradient(circle, #0088CC 0%, transparent 70%)';
                    particle.style.borderRadius = '50%';
                    particle.style.filter = type === 'star' 
                        ? 'drop-shadow(0 0 4px rgba(255, 215, 0, 0.5))'
                        : 'drop-shadow(0 0 4px rgba(0, 136, 204, 0.5))';
                    
                    particles.appendChild(particle);
                    
                    const angle = Math.random() * Math.PI * 2;
                    const distance = 20 + Math.random() * 30;
                    const tx = Math.cos(angle) * distance;
                    const ty = Math.sin(angle) * distance;
                    
                    particle.animate([
                        { 
                            transform: 'translate(0, 0) scale(1)', 
                            opacity: 1
                        },
                        { 
                            transform: `translate(${tx}px, ${ty}px) scale(0.5)`, 
                            opacity: 0
                        }
                    ], {
                        duration: 300 + Math.random() * 200,
                        easing: 'cubic-bezier(0.2, 0, 0.8, 1)'
                    }).onfinish = () => {
                        if (particle.parentNode) {
                            particle.parentNode.removeChild(particle);
                        }
                    };
                }, i * 30);
            }
        }

        function handleClick() {
            stars = parseFloat(stars) + parseFloat(clickPower);
            totalClicks = parseInt(totalClicks) + 1;
            
            const now = Date.now();
            clickTimes.push(now);
            
            mainStar.style.transform = 'scale(0.95)';
            setTimeout(() => mainStar.style.transform = 'scale(1)', 100);
            
            createParticles(2, 'star');
            updateCPS();
            updateDisplay();
            updateUpgradeDisplay();
            updateShopButtons();
            
            if (totalClicks % 10 === 0) {
                saveGame();
            }
        }

        function updateCPS() {
            const now = Date.now();
            clickTimes = clickTimes.filter(time => now - time < 1000);
            cps = clickTimes.length;
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        exchangeBtnTop.addEventListener('click', () => {
            if (exchangeModal.classList.contains('active')) {
                closeExchangeModalFunc();
            } else {
                openExchangeModal();
            }
        });

        promoBtnTop.addEventListener('click', () => {
            if (promoModal.classList.contains('active')) {
                closePromoModalFunc();
            } else {
                openPromoModal();
            }
        });

        shopBtnTop.addEventListener('click', () => {
            if (shopModal.classList.contains('active')) {
                closeShopModalFunc();
            } else {
                openShopModal();
            }
        });

        inventoryBtnTop.addEventListener('click', () => {
            if (inventoryModal.classList.contains('active')) {
                closeInventoryModalFunc();
            } else {
                openInventoryModal();
            }
        });

        closeExchangeModal.addEventListener('click', closeExchangeModalFunc);
        closePromoModal.addEventListener('click', closePromoModalFunc);
        closeShopModal.addEventListener('click', closeShopModalFunc);
        closeInventoryModal.addEventListener('click', closeInventoryModalFunc);

        starsToExchangeEl.addEventListener('input', updateExchangePreview);
        exchangeBtn.addEventListener('click', exchangeStars);
        activatePromoBtn.addEventListener('click', activatePromoCode);
        promoCodeInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                activatePromoCode();
            }
        });

        quickAmountButtons.forEach(button => {
            button.addEventListener('click', () => {
                setExchangeAmount(button.dataset.amount);
            });
        });

        clickUpgradeElement.addEventListener('click', buyClickUpgrade);

        clickArea.addEventListener('click', handleClick);

        document.addEventListener('keydown', (e) => {
            if (e.code === 'Escape') {
                if (exchangeModal.classList.contains('active')) {
                    closeExchangeModalFunc();
                }
                if (promoModal.classList.contains('active')) {
                    closePromoModalFunc();
                }
                if (shopModal.classList.contains('active')) {
                    closeShopModalFunc();
                }
                if (inventoryModal.classList.contains('active')) {
                    closeInventoryModalFunc();
                }
            }
            if (e.code === 'Space' && !exchangeModal.classList.contains('active') && 
                !promoModal.classList.contains('active') && 
                !shopModal.classList.contains('active') && 
                !inventoryModal.classList.contains('active')) {
                e.preventDefault();
                handleClick();
            }
        });

        exchangeModal.addEventListener('click', (e) => {
            if (e.target === exchangeModal && exchangeModal.classList.contains('active')) {
                closeExchangeModalFunc();
            }
        });

        promoModal.addEventListener('click', (e) => {
            if (e.target === promoModal && promoModal.classList.contains('active')) {
                closePromoModalFunc();
            }
        });

        shopModal.addEventListener('click', (e) => {
            if (e.target === shopModal && shopModal.classList.contains('active')) {
                closeShopModalFunc();
            }
        });

        inventoryModal.addEventListener('click', (e) => {
            if (e.target === inventoryModal && inventoryModal.classList.contains('active')) {
                closeInventoryModalFunc();
            }
        });

        exchangeModal.addEventListener('touchstart', (e) => {
            if (e.target === exchangeModal || e.target.classList.contains('exchange-panel')) {
                starsToExchangeEl.blur();
            }
        });

        setInterval(updateCPS, 500);
        setInterval(updateExchangeRate, 8000);

        window.addEventListener('load', () => {
            loadGame();
        });

        window.addEventListener('beforeunload', saveGame);
        setInterval(saveGame, 30000);
    </script>
</body>
</html>